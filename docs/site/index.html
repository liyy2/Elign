<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="ELIGN and FED-GRPO: an animated concept page for post-training equivariant diffusion models with force-field rewards." />
  <title>ELIGN | Dynamic Concept Page</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@400;600;700;800&family=Sora:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body id="top">
  <div class="grain" aria-hidden="true"></div>
  <div class="bg-orb orb-a" aria-hidden="true"></div>
  <div class="bg-orb orb-b" aria-hidden="true"></div>

  <header class="hero section-pad">
    <canvas id="hero-canvas" aria-hidden="true"></canvas>

    <nav class="topbar">
      <a class="brand" href="#top">ELIGN</a>
      <div class="top-links">
        <a href="#story">Method</a>
        <a href="#fed-grpo">FED-GRPO</a>
        <a href="#figures">Figures</a>
      </div>
    </nav>

    <div class="hero-layout">
      <div class="hero-copy reveal in-view">
        <p class="eyebrow">Physics-guided alignment for 3D molecule generation</p>
        <h1>From diffusion pretraining to energy- and force-aligned sampling.</h1>
        <p class="subhead">
          ELIGN post-trains an E(3)-equivariant diffusion policy with FED-GRPO, combining
          grouped policy optimization, force/energy disentanglement, and shaped rewards from
          foundational ML force fields.
        </p>
        <div class="hero-ctas">
          <a class="btn btn-solid" href="#fed-grpo">Explore FED-GRPO</a>
          <a class="btn btn-ghost" href="../paper_code_map.md">Paper ↔ code map</a>
        </div>
      </div>

      <aside class="hero-panel reveal in-view" aria-label="Key ideas">
        <h2>Core Ideas</h2>
        <ul>
          <li><span>Shared-prefix branching</span><em>One prefix, many rollouts</em></li>
          <li><span>Disentangled rewards</span><em>Force and energy channels</em></li>
          <li><span>Group-relative optimization</span><em>Stable ranking signal</em></li>
          <li><span>Physics-informed alignment</span><em>Closer to equilibrium</em></li>
        </ul>
        <div class="formula-block">
          <code>A = w<sub>F</sub> z(F) + w<sub>E</sub> z(E)</code>
          <small>FED-GRPO mixed advantage</small>
        </div>
      </aside>
    </div>

    <div class="hero-metrics reveal in-view">
      <div class="metric">
        <span class="metric-value">E(3)</span>
        <span class="metric-label">Equivariance preserved</span>
      </div>
      <div class="metric">
        <span class="metric-value">PBRS</span>
        <span class="metric-label">Energy shaping return-to-go</span>
      </div>
      <div class="metric">
        <span class="metric-value">K-rollouts</span>
        <span class="metric-label">Grouped relative updates</span>
      </div>
    </div>
  </header>

  <main>
    <section id="story" class="section-pad section-block">
      <div class="section-head reveal">
        <p class="eyebrow">ELIGN at a glance</p>
        <h2>What changes after diffusion pretraining?</h2>
      </div>

      <div class="concept-grid">
        <article class="concept-step reveal is-active" data-step="0">
          <span class="step-index">01</span>
          <h3>Pretrain sampler</h3>
          <p>Train an equivariant diffusion backbone with score matching to model molecular structure distribution.</p>
        </article>
        <article class="concept-step reveal" data-step="1">
          <span class="step-index">02</span>
          <h3>Inject conditions</h3>
          <p>Move to conditional sampling for composition and charge, preparing the policy for controlled generation.</p>
        </article>
        <article class="concept-step reveal" data-step="2">
          <span class="step-index">03</span>
          <h3>Score with MLFF</h3>
          <p>Use foundational force fields to evaluate terminal force and energy, and shape intermediate energy signals.</p>
        </article>
        <article class="concept-step reveal" data-step="3">
          <span class="step-index">04</span>
          <h3>Align with FED-GRPO</h3>
          <p>Optimize a clipped policy objective with group-relative normalized advantages and optional KL regularization.</p>
        </article>
      </div>
    </section>

    <section id="fed-grpo" class="section-pad section-block fed-block">
      <div class="section-head reveal">
        <p class="eyebrow">Interactive mechanics</p>
        <h2>FED-GRPO optimization loop</h2>
      </div>

      <div class="fed-layout">
        <article class="engine-card reveal">
          <h3>Shared prefix → branch → preference model → reward → update</h3>
          <p class="engine-intro">
            The animation runs in four steps: one shared trajectory to the branching point, grouped rollout branches,
            preference-model evaluation, then reward-driven policy update.
          </p>

          <div class="stage-rail" id="stageRail" aria-label="FED-GRPO animation stages">
            <button type="button" class="stage-chip is-active" data-stage="0">1. Shared trajectory</button>
            <button type="button" class="stage-chip" data-stage="1">2. Branch rollouts</button>
            <button type="button" class="stage-chip" data-stage="2">3. Preference model</button>
            <button type="button" class="stage-chip" data-stage="3">4. Reward and update</button>
          </div>

          <div class="sequence-scroller">
            <div class="sequence-canvas" id="fedSequence" data-stage="0" role="img" aria-label="Animated FED-GRPO staged process">
              <svg class="seq-svg" viewBox="0 0 1200 620" aria-hidden="true">
                <path id="edge-main" class="edge edge-main" d="M 150 320 L 360 320" />
                <path id="edge-b1" class="edge edge-branch" d="M 360 320 L 600 205" />
                <path id="edge-b2" class="edge edge-branch" d="M 360 320 L 600 320" />
                <path id="edge-b3" class="edge edge-branch" d="M 360 320 L 600 435" />
                <path id="edge-p1" class="edge edge-pref" d="M 675 205 C 760 210, 800 244, 860 276" />
                <path id="edge-p2" class="edge edge-pref" d="M 675 320 C 760 320, 800 302, 860 286" />
                <path id="edge-p3" class="edge edge-pref" d="M 675 435 C 760 418, 800 348, 860 300" />
                <path id="edge-r" class="edge edge-reward" d="M 930 290 L 1070 236" />
                <path id="edge-u" class="edge edge-update" d="M 930 320 L 1070 392" />

                <circle id="token-main" class="token token-main" cx="150" cy="320" r="10" />
                <circle id="token-b1" class="token token-branch" cx="360" cy="320" r="9" />
                <circle id="token-b2" class="token token-branch" cx="360" cy="320" r="9" />
                <circle id="token-b3" class="token token-branch" cx="360" cy="320" r="9" />
                <circle id="token-p1" class="token token-pref" cx="675" cy="205" r="8" />
                <circle id="token-p2" class="token token-pref" cx="675" cy="320" r="8" />
                <circle id="token-p3" class="token token-pref" cx="675" cy="435" r="8" />
                <circle id="token-r" class="token token-reward" cx="930" cy="290" r="8" />
                <circle id="token-u" class="token token-update" cx="930" cy="320" r="8" />
              </svg>

              <div class="seq-node-card" id="seqStart">Shared Prefix<br /><strong>z<sub>pre</sub></strong></div>
              <div class="seq-node-card seq-hub" id="seqBranch">Branch Point</div>

              <div class="seq-node-card seq-terminal t1" id="seqRollout1">Rollout 1<br /><strong>z<sub>0</sub></strong></div>
              <div class="seq-node-card seq-terminal t2" id="seqRollout2">Rollout 2<br /><strong>z<sub>0</sub></strong></div>
              <div class="seq-node-card seq-terminal t3" id="seqRollout3">Rollout 3<br /><strong>z<sub>0</sub></strong></div>

              <div class="seq-node-card seq-pref-card" id="seqPref">Preference Model<br /><strong>MLFF &phi;</strong></div>
              <div class="seq-node-card seq-reward-card" id="seqReward">Reward<br /><strong>r(z, &phi;)</strong></div>
              <div class="seq-node-card seq-update-card" id="seqUpdate">Policy Update<br /><strong>&theta; &larr; &theta; + &Delta;</strong></div>
            </div>
          </div>

          <p class="sequence-caption" id="sequenceCaption">
            1) A node follows the shared trajectory to the branch point.
          </p>
        </article>
      </div>
    </section>

    <section id="figures" class="section-pad section-block">
      <div class="section-head reveal">
        <p class="eyebrow">Visual anchors</p>
        <h2>Pipeline and optimization diagrams</h2>
      </div>

      <div class="figure-grid">
        <figure class="figure-card reveal">
          <img src="../../assets/figures/fig1_elign_overview.png" alt="ELIGN pipeline from pretraining to post-training alignment" loading="lazy" />
          <figcaption>ELIGN pipeline: pretraining, conditioning, preference modeling, and alignment.</figcaption>
        </figure>
        <figure class="figure-card reveal">
          <img src="../../assets/figures/fig2_fed_grpo_overview.png" alt="FED-GRPO grouped rollout and reward disentanglement overview" loading="lazy" />
          <figcaption>FED-GRPO: shared-prefix branching, shaped energy, and force-energy mixed advantage.</figcaption>
        </figure>
      </div>
    </section>
  </main>

  <footer class="footer section-pad">
    <p>ELIGN project page concept • Built for clear communication of method intuition and optimization dynamics.</p>
    <a href="../../README.md">Back to repository README</a>
  </footer>

  <script src="main.js"></script>
</body>
</html>
